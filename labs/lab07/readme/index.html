
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MSE404.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab06/readme/">
      
      
        <link rel="next" href="../../lab08/readme/">
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Lab 7 - Finite Temperature Properties - MSE404</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#finite-temperature-properties" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MSE404" class="md-header__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSE404
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 7 - Finite Temperature Properties
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MSE404" class="md-nav__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    MSE404
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 - Getting Started in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab02/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2 - Quantum Espresso Input and Output for Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3 - Convergence and Importance Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 - Crystals and Electronic Band Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab05/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 5 - Forces, Stresses and Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab06/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 6 - Vibrational Frequencies and Normal Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab 7 - Finite Temperature Properties
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab08/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 8 - Metals, Spin Polarization and Magnetic Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 9 - Charged system and excited states
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extra labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/using_total_energies/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/visualising_output/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/hydrogen_atom/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/tetrahedron_method/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/tddft/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/high_symmetry_points/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 6
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Extra resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/vmsetup/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual machines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/linuxcommands/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/gnuplot/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gnuplot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/shellscripting/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bash scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/running_in_parallel/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel computing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="finite-temperature-properties">Finite Temperature Properties</h1>
<p>Everything we've done so far has in fact been for systems at effectively zero
temperature. And even at zero temperature, we haven't taken into account the
zero-point motion of the atoms and have treated them as purely classical
objects residing at fixed positions.</p>
<p>In actuality, there will be an effect from the zero-point motion of the
atoms, and as temperature increases the atoms will vibrate with larger
amplitude and this can lead to changes in many properties of a material with
temperature. You will learn how the thermodynamic properties of a material
can be computed from first principles.</p>
<p>Our approach will be to use the type of density functional theory (DFT) and
density functional perturbation theory (DFPT) calculations you've already seen
, and spend more time analysing the output to produce materials properties.</p>
<p>This will involve some reasonably serious numerical calculations, of the kind
that would be quite difficult to do without using some form of mathematical
software. We will use <a href="https://www.python.org/">python</a> to compute the
thermodynamic properties.</p>
<p>We'll be mainly relying on the following libraries:</p>
<ul>
<li><a href="https://www.numpy.org/">numpy</a><ul>
<li>This allows us to easily work with arrays of data.</li>
</ul>
</li>
<li><a href="https://www.scipy.org/">scipy</a><ul>
<li>This gives us many numerical analysis tools.</li>
</ul>
</li>
<li><a href="https://matplotlib.org/">matplotlib</a><ul>
<li>This allows us to easily generate plots.</li>
</ul>
</li>
</ul>
<p>We expect many of you may not be familiar with python, but if you've used
Matlab or Mathematica, you should find the process here somewhat similar, but
with slightly different syntaxes. Python is a very powerful language that you
are most likely to use in future. We will also introduce you to <em>functions</em> and
<em>classes</em>. Functions do specific tasks that you wish to perform. For example, 
you provide some input, a function does some calculations and returns you an
output. Therefore, with a <em>function</em>, you primarily interact (through input  and
output). On the other hand, a <em>class</em> allows you to not only create your own
data type but also interact with it. You will find out that <em>class</em> is
significantly more re-usable.</p>
<p>Let's introduce you to a very simple <em>class</em>. It has two aspects:
implementation, and interaction/usage. Let's look at implementation
of the position of an atom <a href="./class/">position</a>:
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"># Indentation has to be consistent
</span><span id="__span-0-2"># We are using two spaces as indentation.
</span><span id="__span-0-3">
</span><span id="__span-0-4"># Creating a position class
</span><span id="__span-0-5">class Position(object):
</span><span id="__span-0-6">  # Special method __init__ to initialize your data
</span><span id="__span-0-7">  # attributes
</span><span id="__span-0-8">  # Note as opposed to normal function, __init__ contains
</span><span id="__span-0-9">  # self;
</span><span id="__span-0-10">  # self: parameter to refer to an instance of a class
</span><span id="__span-0-11">  # x,y: what you provide while creating this class/calling it
</span><span id="__span-0-12">  def __init__(self, x, y):
</span><span id="__span-0-13">    # self.x or self.y: Look for x/y that belong to this class
</span><span id="__span-0-14">    self.x = x
</span><span id="__span-0-15">    self.y = y
</span><span id="__span-0-16">
</span><span id="__span-0-17">  # Methods that you can use to compute things
</span><span id="__span-0-18">  # Following method computes distance of (x,y) from origin
</span><span id="__span-0-19">  def get_dist_from_origin(self):
</span><span id="__span-0-20">    # Note how the x/y values are called (with self.)
</span><span id="__span-0-21">    dist = (self.x**2.0 + self.y**2.0)**0.5
</span><span id="__span-0-22">    return dist
</span><span id="__span-0-23">
</span><span id="__span-0-24">  # You can add as-many methods as you want
</span></code></pre></div></td></tr></table></div>
This is the content of <code>position.py</code>. Now, let's see how you can
use it. This class can be called to compute the distance of a
point from origin. To do this, run the code <code>run.py</code> using :
<code>python run.py</code> . Now, take a look inside <code>run.py</code> and try to
understand how the calls are made. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"># Import the class Position
</span><span id="__span-1-2">from position import Position
</span><span id="__span-1-3">
</span><span id="__span-1-4">pos = Position(2,3)
</span><span id="__span-1-5"># Access data from class
</span><span id="__span-1-6">print(&quot;x=%.6f&quot;%(pos.x))
</span><span id="__span-1-7">print(&quot;y=%.6f&quot;%(pos.y))
</span><span id="__span-1-8"># Compute distance by calling the function from class
</span><span id="__span-1-9">distance = pos.get_dist_from_origin()
</span><span id="__span-1-10">print(&quot;distance from origin(0,0)=&quot;,distance)
</span></code></pre></div></td></tr></table></div>
<p>Thermodynamic properties of the material involve understanding the
phonon occupation number (or, Bose-Einstein distribution), total
energy within the harmonic approximation, specific heat at constant
volume, Helmholtz free energy, Entropy, etc. In this lab, you will
try to learn to code some of these properties by building on some
existing code for Diamond.</p>
<h1 id="phonon-calculations-on-a-fine-grid">Phonon calculations on a fine-grid</h1>
<p>As you might have noticed, we've already done most of the work
needed to also calculate phonons on a fine-grid in our previous lab
(<a href="../lab06/03_CarbonDiamond">Lab06/Diamond</a>). This can be done
following the <code>q2r.x</code> calculation by choosing some different input
options for <code>matdyn.x</code>.  Take a look at the input file
<a href="../CarbonDiamond/05_CD_matdyn-fine.in"><code>05_CD_matdyn-fine.in</code></a>. The
contents are as follows:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"> &amp;input
</span><span id="__span-2-2">    asr=&#39;simple&#39;
</span><span id="__span-2-3">    flfrc=&#39;CD444.fc&#39;
</span><span id="__span-2-4">    flfrq=&#39;CD-fine.freq&#39;
</span><span id="__span-2-5">    nk1=20,nk2=20,nk3=20
</span><span id="__span-2-6">    nosym=.true.
</span><span id="__span-2-7">    dos=.true.
</span><span id="__span-2-8"> /
</span></code></pre></div></td></tr></table></div>
<p>This is quite similar to the band plot, but now we're setting
<code>nosym</code> to true, choosing a dense q-point grid on which to
recalculate our frequencies. </p>
<p>Run <code>matdyn.x</code> now with this input file. Please do not forget to
copy all the things you did in your previous lab on the same
material (Copy the files from (<a href="../lab06/03_CarbonDiamond">Lab06/Diamond</a>)
directory into <a href="lab07/CarbonDiamond">Lab07/CarbonDiamond</a>. It'll take a bit
longer than the band calculation as it is explicitly computing without invoking
the symmetry. The file it generates: <code>CD-fine.freq</code>. We will utilize this file
to compute several thermodynamic properties using python.</p>
<h1 id="thermodynamic-properties">Thermodynamic properties</h1>
<p>Some key quantities are (For reference, see
<a href="https://en.wikipedia.org/wiki/Quasi-harmonic_approximation">Wikipedia</a> and
 and the reference therein):</p>
<h2 id="bose-einstein-distribution">Bose-Einstein distribution</h2>
<p><span class="arithmatex">\(n_{BE}(T) = \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}\)</span></p>
<h2 id="total-energy-due-to-phonons">Total Energy due to phonons</h2>
<p>Total energy due to phonons within harmonic approximation can be 
written as,</p>
<div class="arithmatex">\[E(T) = \sum_{\mathbf{q}\nu}\hbar\omega(\mathbf{q}\nu)\left[\frac{1}{2} + \frac{1}{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1}\right]\]</div>
<h2 id="constant-volume-heat-capacity">Constant volume heat capacity</h2>
<p>Specific heat at constant volume can be obtained from the total 
energy calculations:</p>
<div class="arithmatex">\[C_{V} = \left(\frac{\partial E}{\partial T} \right ) = \sum_{\mathbf{q}\nu} k_\mathrm{B} \left(\frac{\hbar\omega(\mathbf{q}\nu)}{k_\mathrm{B} T} \right)^2 \frac{\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)}{[\exp(\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)-1]^2}\]</div>
<h2 id="helmholtz-free-energy">Helmholtz free energy</h2>
<p>To compute the Helmholtz free energy, we need the partition function,
<span class="arithmatex">\(Z\)</span>.</p>
<div class="arithmatex">\[Z = \exp(-\varphi/k_\mathrm{B} T) \prod_{\mathbf{q}\nu} \frac{\exp(-\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)}{1-\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T)}\]</div>
<div class="arithmatex">\[H(T) = -k_\mathrm{B} T \ln Z = \varphi + \frac{1}{2} \sum_{\mathbf{q}\nu} \hbar\omega(\mathbf{q}\nu) + k_\mathrm{B} T \sum_{\mathbf{q}\nu} \ln \bigl[1 -\exp(-\hbar\omega(\mathbf{q}\nu)/k_\mathrm{B} T) \bigr]\]</div>
<h2 id="entropy">Entropy</h2>
<p>Entropy, <span class="arithmatex">\(S\)</span> can also be computed:
<span class="arithmatex">\(<span class="arithmatex">\(S = -\frac{\partial H}{\partial T} = \frac{1}{2T} \sum_{\mathbf{q}\nu} \hbar\omega(\mathbf{q}\nu) \coth(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)-k_\mathrm{B} \sum_{\mathbf{q}\nu} \ln \left[2\sinh(\hbar\omega(\mathbf{q}\nu)/2k_\mathrm{B}T)\right]\)</span>\)</span></p>
<p>Note that the temperature dependence in all these quantities are
determined by the Bose-Einstein distribution.</p>
<p>We have implemented these codes using python. For example, you will
find a folder <a href="03_CarbonDiamond/Thermodynamics"><code>Thermodynamics</code></a>
containing a file <code>thermo.py</code> that has all these quantities you need. It reads
the phonon bands calculations at a fine-grid and can compute several
thermodynamic properties. For the implementation of total energy due to
harmonic phonon, look up the function, <em>get_E_T</em> inside the <code>thermo.py</code> file:</p>
<p><code>def get_E_T(self):
    """
    Computes total energy at a Temperature
    @output
      E_T, in units of meV
      NOTE: E_T/nkp is returned
    """
    E_T = 0.0
    # For every band n
    for n in range(self.omega_nq.shape[0]):
      # For every band q
      for q in range(self.omega_nq.shape[1]):
        omega = self.omega_nq[n][q]
        E_T = E_T + \
              (omega*\
              (0.5 + self.befactor(omega)))
    return E_T/self.omega_nq.shape[1]</code></p>
<p>You can compute the total energy at a given temperature by running
the <code>compute.py</code>: <code>python compute.py</code></p>
<p>Try understanding how the calculations are performed and how are
they implemented. Note that, all the calculations internaly
converts temperature to meV (i.e. <span class="arithmatex">\(T \to k_{B}T\)</span>) and phonon
energies to meV (from cm<span class="arithmatex">\(^{-1}\)</span>).</p>
<h3 id="task"><em>Task</em></h3>
<ul>
<li>Run the calculations at a temperature 20 K.</li>
<li>Compute the temperature dependence of <span class="arithmatex">\(E, C_{V}, H, S\)</span> for 
  several temperatures, ranging from 10 K to 1000 K in steps
  of 20 K. What happens to specific heat at low-temperature?
  You will see a lot more details on your homework.
  <strong>Hint:</strong> Write a <em>for</em> loop to do this.</li>
<li>Plot these data using matplotlib.</li>
<li>Try increasing the grid-size from <span class="arithmatex">\(20\times20\times20\)</span> to a larger number and
  try reducing as well. What happens?</li>
</ul>
<p><strong>NOTE:</strong>  An important contribution in the total energy,
entropy, etc. are missing in the above calculations: the
contribution without the phonons. For example, the total energy of
a material at a given temperature is, $$ E(T)= E_{ph}(T) + E_{DFT}$$,
where <span class="arithmatex">\(E_{DFT}\)</span> is the contribution without phonon (sometimes,
referred to as lattice energy). Another important point to note is
that they are all dependent on the volume of the material.
Similarly, the Helmohltz free energy can be written as <span class="arithmatex">\(H = E_{DFT}+ E_{ph} - TS\)</span>. A thermodynamic state is described by two
independent parameters, let's take them as <span class="arithmatex">\(T\)</span> and <span class="arithmatex">\(V\)</span>. The
free-energy, <span class="arithmatex">\(H(T,V)\)</span>. So, in principle, one should compute the
free-energy for several volumes at any temperature or vice-versa,
to represent the thermodynamic state correctly. This leads us to
something called, <strong>quasi-harmonic approximation</strong>. This
approximation is a harmonic-phonon-based model used
to describe volume-dependent thermal effects, such as
the thermal expansion of a material. This approximation assumes
that the harmonic approximation holds for every value of the
lattice constant, viewed as an adjustable parameter. </p>
<h2 id="thermal-expansion-of-a-solid">Thermal Expansion of a Solid</h2>
<p>$$ \alpha = (\frac{1}{V} \frac{\partial V}{\partial T})$$ at a constant
pressure. Note that the volume, <span class="arithmatex">\(V\)</span> is obtained by minimizing Gibbs
free energy, <span class="arithmatex">\(G=H+PV\)</span>. Assuming a zero-external pressure, we can
minimize H at every temperature and obtain the thermal expansion
coefficient. You will find this in the <a href="Si_TEC">Si_TEC</a>. </p>
<h3 id="task_1"><em>Task</em></h3>
<p>The calculations has three steps:
1. Run the total energy and phonon calculations for several volumes.
2. Compute the Helmohtz free energy for any temperature for these volumes.
3. Obtain the minimum for for each temperature and compute V vs. T.
4. Write a small python code to compute <span class="arithmatex">\(\alpha\)</span> using the scripts
provided in <a href="Si_TEC/TEC">TEC</a> folder.</p>
<p>The first-step can be established using running several
calculations<code>bash EvsV.sh</code>. After this step, go to
<a href="Si_TEC/TEC">TEC</a> directory and run <code>compute.py</code>.If you recall, it
took around 5 minutes to calculate the phonon band-structure for a
single volume last time. Doing this 6 times would take half an
hour. For this reason, we've included the dos files that would be
generated. <strong>You don't need to run the calculation here and can
proceed to the analysis</strong> <a href="Si_TEC/TEC">TEC</a></p>
<hr />
<h2 id="summary">Summary</h2>
<p>In this lab you have seen:</p>
<ul>
<li>For a solid we used</li>
<li>python code to compute several thermodynamic properties computed using DFT+DFPT calculations.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>