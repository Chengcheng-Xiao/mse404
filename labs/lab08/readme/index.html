
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MSE404.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab07/readme/">
      
      
        <link rel="next" href="../../lab09/readme/">
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Lab 8 - Metals, Spin Polarization and Magnetic Systems - MSE404</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metals-spin-polarization-and-magnetic-systems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MSE404" class="md-header__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSE404
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 8 - Metals, Spin Polarization and Magnetic Systems
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MSE404" class="md-nav__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    MSE404
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 - Getting Started in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab02/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2 - Quantum Espresso Input and Output for Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3 - Convergence and Importance Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 - Crystals and Electronic Band Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab05/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 5 - Forces, Stresses and Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab06/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 6 - Vibrational Frequencies and Normal Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab07/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 7 - Finite Temperature Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab 8 - Metals, Spin Polarization and Magnetic Systems
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab 8 - Metals, Spin Polarization and Magnetic Systems
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metals" class="md-nav__link">
    <span class="md-ellipsis">
      Metals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-aluminium" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Aluminium
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spin-polarization" class="md-nav__link">
    <span class="md-ellipsis">
      Spin Polarization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-oxygen-molecule" class="md-nav__link">
    <span class="md-ellipsis">
      The Oxygen Molecule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iron" class="md-nav__link">
    <span class="md-ellipsis">
      Iron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 9 - Charged system and excited states
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extra labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/using_total_energies/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/visualising_output/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/hydrogen_atom/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/tetrahedron_method/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/tddft/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/labs/high_symmetry_points/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 6
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Extra resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/vmsetup/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual machines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/linuxcommands/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/gnuplot/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gnuplot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/shellscripting/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bash scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extras/misc/running_in_parallel/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel computing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metals" class="md-nav__link">
    <span class="md-ellipsis">
      Metals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-aluminium" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Aluminium
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spin-polarization" class="md-nav__link">
    <span class="md-ellipsis">
      Spin Polarization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-oxygen-molecule" class="md-nav__link">
    <span class="md-ellipsis">
      The Oxygen Molecule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iron" class="md-nav__link">
    <span class="md-ellipsis">
      Iron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="metals-spin-polarization-and-magnetic-systems">Metals, Spin Polarization and Magnetic Systems</h1>
<p>This week we'll cover two topics: metallic systems and spin. For metals,
there are a couple of complications which mean we have to treat them
differently from systems with a non-zero band gap.</p>
<hr />
<h2 id="metals">Metals</h2>
<p>Metals have a Fermi surface that can be quite complex in k-space. This means
that in contrast to an insulator or semiconductor where every k-point has the
same number of occupied states, <strong>in a metal the number of occupied states can
vary from k-point to k-point</strong>. This makes them more difficult to converge than
other systems. </p>
<p>In short, there are generally two things you need to do:</p>
<ol>
<li>
<p>Use a denser k-point grid than you would need for a semiconductor or
    insulator. This is to help sampling the rapid change in the Fermi surface at
    different k-points.</p>
</li>
<li>
<p>Use some smearing scheme. This is in relation to the smearing used in the
    calculation of the <a href="../../lab04/readme/#density-of-states"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:" /> density of
    states</a>. The difference is that here
    the occupation is also smeared (i.e., can no longer be intergers of 0 and
    1.) Visually, the smeared DOS would look like the following:</p>
<p>where the occupation function (Fermi-Dirac function) is plotted in red. The
Fermi energy is obtaeind by solving the following equaion:
$$ 
\int_{-\infty}^{\varepsilon_F} \mathrm{DOS}(\varepsilon) f_T(\varepsilon)
d\varepsilon = N_e 
$$
where <span class="arithmatex">\(N_e\)</span> is the number of electrons in the system and <span class="arithmatex">\(f\)</span> represents the
Fermi-Dirac distribution function at temperature <span class="arithmatex">\(T\)</span>. As we already know, 
the Fermi-Dirac function at 0K is a step function which would spoil the
convergence of metals. Here, we simply raise the temperature to a small
number (<code>degauss</code>) so that the Fermi-Dirac function is smeared out and the
Convergence can be more easily achieved. It is worth noting that other
smearing methods such as gaussian smearing can also be used.</p>
<p>Adding a smearing helps significantly in achieving a smooth
SCF convergence, as otherwise a small change in a state energy from once
cycle to the next could lead to a very large change in its occupation and to
the total energy in turn (this is called 'ill-conditioning'). 
We set the smearing scheme and width with the <code>occupations</code> and <code>degauss</code> 
variables in the input file.</p>
</li>
</ol>
<h2 id="example-aluminium">Example: Aluminium</h2>
<p>Aluminium forms in a standard fcc structure with one atom per cell, which we
know how to deal with at this point. The thing about Aluminium that makes it
more complicated within DFT is that it is a metal.</p>
<p>Here is an example input file for a calculation of Aluminium:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-0-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-0-3"> <span class="o">/</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-0-6">    <span class="n">ibrav</span> <span class="o">=</span>  <span class="mi">2</span>
</span><span id="__span-0-7">    <span class="n">A</span> <span class="o">=</span> <span class="mf">2.863</span>
</span><span id="__span-0-8">    <span class="n">nat</span> <span class="o">=</span>  <span class="mi">1</span>
</span><span id="__span-0-9">    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-10">    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">18.0</span>
</span><span id="__span-0-11">    <span class="n">occupations</span> <span class="o">=</span> <span class="s1">&#39;smearing&#39;</span> <span class="c1">#(1)!</span>
</span><span id="__span-0-12">    <span class="n">smearing</span> <span class="o">=</span> <span class="s1">&#39;fermi-dirac&#39;</span> <span class="c1">#(2)!</span>
</span><span id="__span-0-13">    <span class="n">degauss</span> <span class="o">=</span> <span class="mf">0.1</span><span class="n">d0</span> <span class="c1">#(3)!</span>
</span><span id="__span-0-14"> <span class="o">/</span>
</span><span id="__span-0-15">
</span><span id="__span-0-16"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-0-17"> <span class="o">/</span>
</span><span id="__span-0-18">
</span><span id="__span-0-19"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-0-20"> <span class="n">Al</span>  <span class="mf">26.982</span>  <span class="n">Al</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">vbc</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-0-21">
</span><span id="__span-0-22"><span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
</span><span id="__span-0-23"> <span class="n">Al</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
</span><span id="__span-0-24">
</span><span id="__span-0-25"><span class="n">K_POINTS</span> <span class="n">automatic</span>
</span><span id="__span-0-26">  <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>The <code>occupations</code> variable is set to <code>smearing</code> to tell Quantum Espresso
      to use a smearing scheme <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm362"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:" />input 
      description</a>.</li>
<li>The <code>smearing</code> variable is set to <code>fermi-dirac</code> to tell Quantum Espresso
      to use a Fermi-Dirac smearing scheme. <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm404"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:" />input
      description</a>. </li>
<li>The <code>degauss</code> variable is set to 0.1d0 to set the width of the smearing.
      see <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm401"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:" />input
      description</a>.</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Task 1 - Smearing</p>
<p>First, run the <code>pw.x</code> calculation with the supplied input file in
<a href="../01_aluminium/Al.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:" />01_aluminium/Al.in</a>.</p>
<p>Then, look in the <code>pwscf.xml</code> file and find the various <code>ks_energies</code>
entries towards the end. These give the various k-points used in the
calculation and the energies and occupations of each state for this k-point.
Note, for a metal the default number of bands is at least four more than are
needed for the number of electrons per cell. The pseudopotential we have
used has 3 valence electrons, which could be represented with two
potentially doubly occupied bands, so we have four more bands in the
calculation for a total of 6.</p>
<details class="success">
<summary>Example</summary>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">      &lt;ks_energies&gt;
</span><span id="__span-1-2">        &lt;k_point weight=&quot;7.812500000000000E-003&quot;&gt;-6.250000000000000E-002  6.250000000000000E-002  6.250000000000000E-002&lt;/k_point&gt;
</span><span id="__span-1-3">        &lt;npw&gt;59&lt;/npw&gt;
</span><span id="__span-1-4">        &lt;eigenvalues size=&quot;6&quot;&gt;
</span><span id="__span-1-5">  1.315972343567215E-001  1.505697520824042E+000  1.607697079464305E+000
</span><span id="__span-1-6">  1.607697714947740E+000  1.834366371282428E+000
</span><span id="__span-1-7">  1.952726961146777E+000
</span><span id="__span-1-8">        &lt;/eigenvalues&gt;
</span><span id="__span-1-9">        &lt;occupations size=&quot;6&quot;&gt;
</span><span id="__span-1-10">  9.999990177787399E-001  1.181697427742303E-006  1.536561074875367E-007
</span><span id="__span-1-11">  1.536541545820267E-007  1.650917762173208E-009
</span><span id="__span-1-12">  1.547598926179030E-010
</span><span id="__span-1-13">        &lt;/occupations&gt;
</span><span id="__span-1-14">      &lt;/ks_energies&gt;
</span><span id="__span-1-15"> ... 
</span></code></pre></div></td></tr></table></div>
</details>
<p>Now, try removing the <code>occupations</code> and <code>degauss</code> variables from the input
file and see what happens when you try to run the calculation.</p>
<details class="success">
<summary>Example</summary>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span><span id="__span-2-2">     Error in routine electrons (1):
</span><span id="__span-2-3">     charge is wrong: smearing is needed
</span><span id="__span-2-4">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span></code></pre></div></td></tr></table></div>
</details>
</div>
<hr />
<h2 id="spin-polarization">Spin Polarization</h2>
<p>Up till now we have been assuming that we always had some set of bands which
could each fit two identical electrons. Essentially we have been ignoring
the electron spin. If you want to examine, for example, a magnetic system
then the spin of the electrons is important. It can also be important
in modelling atomic or molecular systems. We'll cover different examples
of this in this lab. </p>
<h2 id="the-oxygen-molecule">The Oxygen Molecule</h2>
<p>If a system is not necessarily magnetic we might imagine that representing 
it with some set of fully occupied, doubly degenerate bands will work. However,
in some cases including spin polarization can lead to important differences. One
example of this is the O2 molecule.</p>
<p><img align="right" alt="MO" src="../assets/Mo_diagram.svg" style="width:250px" /></p>
<p>In this case, we have a system with two interacting oxygen atoms. Each oxygen
has 8 electrons in total, with the configuration <code>1s2 2s2 2p4</code> (the 1s orbital
will be contained within the pseudopotential for the DFT calculations done
here, so you will have 6 electrons from each oxygen atom). </p>
<p>For a single oxygen, from Hund's rule the three p orbitals should be filled
singly before being filled in pairs, so that one of the p-orbitals will have two
electrons, and the other two should have one each. However, if we assume doubly
occupied orbitals, we'll have the two p-orbitals with two electrons and one that
is empty. This means a calculation where we assume a set of doubly occupied
bands will have trouble converging to the ground state of the system. For the
molecule the situation is similar, but the s and p orbitals from each atom
combine to form bonding and anti-bonding <span class="arithmatex">\(\sigma\)</span> and <span class="arithmatex">\(\pi\)</span> orbitals.</p>
<p>The directory <code>02_O2</code> contains an input file to calculate the total energy of
the system at the measured bond length. Here the calculation has been set up
exactly as you've seen in the past (i.e., assuming doubly degenerate band
occupation without smearing or spin polarization:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-3-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-3-3"> <span class="o">/</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-3-6">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-3-7">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-3-8">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-3-9">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-3-10">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-3-11">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-3-12"> <span class="o">/</span>
</span><span id="__span-3-13">
</span><span id="__span-3-14"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-3-15"> <span class="o">/</span>
</span><span id="__span-3-16">
</span><span id="__span-3-17"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-3-18"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-3-19">
</span><span id="__span-3-20"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-3-21"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-3-22"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-3-23">
</span><span id="__span-3-24"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 2.1 - Assming Spin Degenerate Insulator</p>
<p>Try running the calculation in this directory. Does it converge?</p>
<details class="success">
<summary>Answer</summary>
<p>While it's possible that the system may randomly meet the convergence
criteria in the self-consistent cycle, this calculation will most likely
not converge. If you look at the estimate accuracy at the end of each
iteration in the output, it will likely vary from step to step, rather than
steadily decreasing as in a well-behaved calculation.</p>
<p>The situation we have is similar to a metal: we have two bands and the ground
state of the system should be when there is one electron in each of them.</p>
</details>
</div>
<p>To get around this, we can use a metallic occupation scheme with a small
smearing width. This will allow the system to converge to the correct ground
state. The relevant input variables are the ones highlighed below:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-4-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-4-3"> <span class="o">/</span>
</span><span id="__span-4-4">
</span><span id="__span-4-5"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-4-6">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-4-7">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-4-8">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-4-9">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-4-10">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-4-11">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-4-12"><span class="hll">   <span class="n">occupations</span> <span class="o">=</span> <span class="s1">&#39;smearing&#39;</span> 
</span></span><span id="__span-4-13"><span class="hll">   <span class="n">smearing</span> <span class="o">=</span> <span class="s1">&#39;fermi-dirac&#39;</span>
</span></span><span id="__span-4-14"><span class="hll">   <span class="n">degauss</span> <span class="o">=</span> <span class="mf">0.1</span><span class="n">d0</span>
</span></span><span id="__span-4-15"> <span class="o">/</span>
</span><span id="__span-4-16">
</span><span id="__span-4-17"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-4-18"> <span class="o">/</span>
</span><span id="__span-4-19">
</span><span id="__span-4-20"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-4-21"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-4-22">
</span><span id="__span-4-23"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-4-24"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-4-25"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-4-26">
</span><span id="__span-4-27"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 2.2 - Assuming Spin Degenerate Metal</p>
<p>Create a copy of the <code>02_O2</code> directory called <code>02_O2_metal</code>. Modify the
input file in it to use a metallic occupation scheme with a small smearing
width and run the calculation (as above). </p>
<ul>
<li>Does the calculation now converge?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Yes, the calculation should now converge.</p>
</details>
<ul>
<li>Take a look at the file <code>pwscf.xml</code> in the calculation directory, and
  try to find the occupations of each band at each k-point. Are these as
  expected?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>The occupations should be fractional for the highest occupied valence
band which is not physical for a molecule.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">        &lt;occupations size=&quot;8&quot;&gt;
</span><span id="__span-5-2">  9.999997613058770E-001  9.999680732750561E-001  9.800308333633008E-001
</span><span id="__span-5-3">  9.433101748955524E-001  9.433101708179502E-001
</span><span id="__span-5-4">  5.459533880551336E-001  5.459533513549418E-001  4.147424691420094E-002
</span><span id="__span-5-5">        &lt;/occupations&gt;
</span></code></pre></div></td></tr></table></div></p>
</details>
</div>
<p>While treating this system as a metal may help converging the calculation, it
may not necessarily reach the ground state since the spin-degress of freedom is
constrained. Instead, we can do a spin polarized calculation by adding <code>nspin</code>
and <code>tot_magnetization</code> variables to the input file (highlighted below):</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-6-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-6-3"> <span class="o">/</span>
</span><span id="__span-6-4">
</span><span id="__span-6-5"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-6-6">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-6-7">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-6-8">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-6-9">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-6-10">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-6-11">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-6-12"><span class="hll">   <span class="n">nspin</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#(1)!</span>
</span></span><span id="__span-6-13"><span class="hll">   <span class="n">tot_magnetization</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1">#(2)!</span>
</span></span><span id="__span-6-14"> <span class="o">/</span>
</span><span id="__span-6-15">
</span><span id="__span-6-16"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-6-17"> <span class="o">/</span>
</span><span id="__span-6-18">
</span><span id="__span-6-19"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-6-20"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-6-21">
</span><span id="__span-6-22"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-6-23"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-6-24"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-6-25">
</span><span id="__span-6-26"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li><code>nspin</code>: this is 1 by default so no spin polarization is taken into 
      account. To perform a spin polarized calculation it should be set to 2.</li>
<li><code>tot_magnetization</code>: this is difference between the number of spin-up and
      spin-down electrons in the cell. If we want a single spin up electron
      we can set this to <code>1.0</code>.</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Task 2.3 - Assuming Spin Polarized Metal</p>
<p>Create another copy of <code>02_O2</code> called <code>02_O2_spin</code>. Then, try to:</p>
<ol>
<li>
<p>Only turn on spin polarization. Does the calculation run?</p>
<details class="success">
<summary>Answer</summary>
<p>The calculation will not run.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span><span id="__span-7-2">    Error in routine iosys (1):
</span><span id="__span-7-3">    fixed occupations and lsda need tot_magnetization
</span><span id="__span-7-4">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span></code></pre></div></td></tr></table></div></p>
</details>
</li>
<li>
<p>Setting the total magnetization to 0, which would be the case if we 
   don't have any net magnetization in the molecule, as both spins point in
   opposite directions. </p>
<details class="success">
<summary>Answer</summary>
<p>The calculation converges to an energy of -63.25520699 Ry.</p>
</details>
</li>
<li>
<p>Setting the total magnetization to 2.0, which corresponds
   to both spins pointing in the same direction. Is the energy lower? How do
   the orbital energies vary?</p>
<details class="success">
<summary>Answer</summary>
<p>The calculation converges to an energy of -63.29338911 Ry. The
energy becomes lower with this configuration and the orbital
energies become different between spin channels.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1">      &lt;ks_energies&gt;
</span><span id="__span-8-2">        &lt;k_point weight=&quot;1.00000000000000&quot;&gt;0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000&lt;/k_point&gt;
</span><span id="__span-8-3">        &lt;npw&gt;26462&lt;/npw&gt;
</span><span id="__span-8-4">        &lt;eigenvalues size=&quot;16&quot;&gt;
</span><span id="__span-8-5"> -1.025922874232402E+000 -7.812538236389854E-001 -4.590520636167327E-001
</span><span id="__span-8-6"> -4.198711506107195E-001 -3.871387741292614E-001
</span><span id="__span-8-7"> -2.912685945326537E-001 -2.532555221576769E-001 -1.076727247566867E-001
</span><span id="__span-8-8"> -1.025922792354764E+000 -7.812537346931661E-001
</span><span id="__span-8-9"> -4.590520549643138E-001 -4.198710925526331E-001 -3.871386455493686E-001
</span><span id="__span-8-10"> -2.912685126157339E-001 -2.532553593136832E-001
</span><span id="__span-8-11"> -1.076726566570645E-001
</span><span id="__span-8-12">        &lt;/eigenvalues&gt;
</span><span id="__span-8-13">        &lt;occupations size=&quot;16&quot;&gt;
</span><span id="__span-8-14">  1.000000000000000E+000  1.000000000000000E+000  1.000000000000000E+000
</span><span id="__span-8-15">  1.000000000000000E+000  1.000000000000000E+000
</span><span id="__span-8-16">  1.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
</span><span id="__span-8-17">  1.000000000000000E+000  1.000000000000000E+000
</span><span id="__span-8-18">  1.000000000000000E+000  1.000000000000000E+000  1.000000000000000E+000
</span><span id="__span-8-19">  1.000000000000000E+000  0.000000000000000E+000
</span><span id="__span-8-20">  0.000000000000000E+000
</span><span id="__span-8-21">        &lt;/occupations&gt;
</span><span id="__span-8-22">      &lt;/ks_energies&gt;
</span></code></pre></div></td></tr></table></div></p>
</details>
</li>
</ol>
</div>
<p>Finally, comparing the energy of the spin polarized calculation with the spin
degnerate metal calculation, we can see that the spin polarized calculation
gives a lower energy.</p>
<div class="admonition pied-piper">
<p class="admonition-title">Fun facts</p>
<p>O2 in its singlet state can be dangerous (see e.g. 
<a href="https://www.sciencedirect.com/science/article/pii/S1383574211001189"><code>this paper</code></a>),
so treating the spin correctly is important!</p>
</div>
<h2 id="iron">Iron</h2>
<p>Now that you've seen how including spin polarization can allow us a correctly
describe the ground state of our system in your calculation, the next step
is to use it to describe a magnetic system.</p>
<p>In a magnetic system there is a net spin polarization in the unit cell. This
means that we'll probably have an odd number of electrons, and the energy of
the system when we include a net spin polarization is lower than the energy
when we don't.</p>
<p>One of the most common magnetic systems is iron, so we'll examine this. The
directory <code>03_Fe</code> contains an input file for iron. Note this is a BCC structure
(as set by <code>ibrav = 3</code> in the input file), whereas most of the crystals
structures you have examined previously were FCC. The calculation has been set
up in the usual way for a metallic system.</p>
<div class="admonition example">
<p class="admonition-title">Task 3.1 - fixed magnetization</p>
<ol>
<li>
<p>Run this calculation and check everything worked as expected. What is the
   final energy?</p>
<details class="success">
<summary>Answer</summary>
<p>The final energy should be -55.52528610 Ry.</p>
</details>
</li>
<li>
<p>Now make a copy of the calculation directory and in this, modify the
   calculation to turn on spin polarization. Try running the calculation
   with <code>tot_magnetization = 0.0</code> first, and compare your total energy to that
   obtained using doubly degenerate bands. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>while in the case of the O2 above, we were able to get our
calculations to at least converge by using a metallic occupation
instead of using spin polarization, in the case of iron, it will still
be a metal when you use spin polarization, so you should not remove
the input variables associated with this. </p>
</div>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.52528589 Ry. Almost identical to the
one obtained with the doubly degenerate bands. This is because these
two calculations are essentially identical.</p>
</details>
</li>
<li>
<p>Now try setting the total magnetization to 1.0 and see how total energy
   changes: Which is the more energetically favourable configuration?</p>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.53839616 Ry. Lower than the spin
degenerate case.</p>
</details>
</li>
<li>
<p>Try setting the total magnetization to 2.0. How does the final energy
   compare to the previous value?</p>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.56226730 Ry. Lower than all previous
cases.</p>
</details>
</li>
</ol>
</div>
<p>From this we could test many guesses for the total magnetization, and find
the value which gives the lowest overall total energy. However, we can instead
pass an option that tells quantum espresso to automatically find the best
value. This is done by setting the <code>starting_magnetization</code> input variable.</p>
<div class="admonition example">
<p class="admonition-title">Task 3.2 - Relaxed magnetization</p>
<ol>
<li>
<p>Make another copy of the <code>03_Fe</code> directory, and this time set <code>nspin = 2</code>,
   and <code>starting_magnetization = 1.0</code> (do not include the
   <code>tot_magnetization</code> variable as this fixes a value). Run the calculation
   and see what the final total magnetization per cell is. See if you can
   find a measured value for iron to compare to.</p>
<details class="success">
<summary>Answer</summary>
<p>The total magnetization becomes larger than 2.0.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1">total magnetization       =     2.21 Bohr mag/cell
</span></code></pre></div></td></tr></table></div>
This is becuase we are allowing the spin to fully relax in the
system.</p>
</details>
</li>
<li>
<p>See if you can use what we covered in previous labs to calculate and make a
   plot of the electronic band structure of BCC Fe.</p>
<ul>
<li>Plot the spin-up and spin-down bands in different colours.</li>
<li>Indicate the Fermi energy on your plot in some sensible way.</li>
<li>As the Brillouin zone is different to the ones you have calculated so
  far you'll need to select a few sensible high-symmetry points yourself
  to plot with <img alt="ðŸ™‚" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f642.svg" title=":slight_smile:" />.</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>You can find the relevant input file in the directory 
<code>03_Fe/extra_bandstructure</code>. Give the <code>run_all.sh</code> file a read and
try to run the calculation. The band structure should look like The
following:
<figure markdown="span">
  <img alt="Diamond primitive cell" src="../assets/Iron_bands.png" width="500" />
</figure></p>
</details>
</li>
</ol>
</div>
<hr />
<h2 id="summary">Summary</h2>
<p>In this lab you have seen:</p>
<ul>
<li>How to treat a metallic system.</li>
<li>How to do a DFT calculation including spin polarization.</li>
<li>How some systems need to be done with spin polarization to converge to the
  correct ground state.</li>
<li>How to use spin polarized calculations to find the correct magnetization of a
  magnetic system by letting the code find the total magnetization that produces
  the lowest overall total energy.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>