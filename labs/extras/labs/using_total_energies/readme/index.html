
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MSE404.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../../../lab09/readme/">
      
      
        <link rel="next" href="../../visualising_output/readme/">
      
      
      <link rel="icon" href="../../../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Ex Lab 1 - MSE404</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#additional-material-calculating-useful-properties-from-total-energies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="MSE404" class="md-header__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSE404
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ex Lab 1
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="MSE404" class="md-nav__button md-logo" aria-label="MSE404" data-md-component="logo">
      
  <img src="../../../../../assets/IMPV2.svg" alt="logo">

    </a>
    MSE404
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chengcheng-Xiao/mse404" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Chengcheng-Xiao/mse404
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab01/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 - Getting Started in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab02/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2 - Quantum Espresso Input and Output for Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab03/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3 - Convergence and Importance Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab04/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 - Crystals and Electronic Band Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab05/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 5 - Forces, Stresses and Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab06/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 6 - Vibrational Frequencies and Normal Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab07/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 7 - Finite Temperature Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab08/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 8 - Metals, Spin Polarization and Magnetic Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lab09/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 9 - Charged system and excited states
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extra labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Ex Lab 1
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Ex Lab 1
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-can-we-do-with-total-energies" class="md-nav__link">
    <span class="md-ellipsis">
      What can we do with total energies?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predicting-volume" class="md-nav__link">
    <span class="md-ellipsis">
      Predicting volume
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predicting volume">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bulk-modulus-of-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk Modulus of diamond
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bulk Modulus of diamond">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task_1" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#h2-bond-length" class="md-nav__link">
    <span class="md-ellipsis">
      H2 Bond Length
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#h2-vibration-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      H2 Vibration Frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="H2 Vibration Frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task_2" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualising_output/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hydrogen_atom/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tetrahedron_method/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tddft/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../high_symmetry_points/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ex Lab 6
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extra resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Extra resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/vmsetup/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual machines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/linuxcommands/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/gnuplot/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gnuplot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/shellscripting/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bash scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/running_in_parallel/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel computing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-can-we-do-with-total-energies" class="md-nav__link">
    <span class="md-ellipsis">
      What can we do with total energies?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predicting-volume" class="md-nav__link">
    <span class="md-ellipsis">
      Predicting volume
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predicting volume">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bulk-modulus-of-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk Modulus of diamond
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bulk Modulus of diamond">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task_1" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#h2-bond-length" class="md-nav__link">
    <span class="md-ellipsis">
      H2 Bond Length
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#h2-vibration-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      H2 Vibration Frequency
    </span>
  </a>
  
    <nav class="md-nav" aria-label="H2 Vibration Frequency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task_2" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="additional-material-calculating-useful-properties-from-total-energies">Additional Material: Calculating Useful Properties from Total Energies</h1>
<p>Once you can calculate a converged total energy for a given structure, you
already know enough to calculate many useful materials properties.</p>
<h2 id="what-can-we-do-with-total-energies">What can we do with total energies?</h2>
<p>The DFT total energy on its own is not a very useful number, but changes and
differences in the total energy with respect to some input parameter can be
used to calculate many materials properties.</p>
<h2 id="predicting-volume">Predicting volume</h2>
<p>If we calculate the total energy of say diamond as a function of volume, the
volume at which the total energy is minimized will be the theoretically
predicted volume.</p>
<p>Let's do this in the directory <a href="01_diamond_volume"><code>01_diamond_volume</code></a>. We
could set up a series of calculations manually, where we generate a set of
input files each with a slightly different value of the input lattice length.
Then we would run each of these calculations, and finally gather the total
energy vs cell volume in a data file. Or, we could write a script that would
do all this for us.</p>
<p>We already have a template file set up as
<a href="../01_diamond_volume/C_diamond_base.in"><code>C_diamond_base.in</code></a>. Take a look at
this now. It's set up such that the value of the <code>A</code> variable will be replaced
in the automatically generated input files. Note, we're using a fairly high
energy cut-off here also. <strong>In principle once the calculation is set up, we
will need to explicitly test the convergence of the predicted volume versus
energy cut-off.</strong></p>
<p>The script will need to be slightly more complex than previously, as we'd
managed to get by with just producing integer values in our scripts
previously. Now we'll need to produce floating point values for <code>A</code> to get
the resolution we would like. To do this, we can use the
<a href="../../../misc/linuxcommands/readme/#bc"><code>bc</code></a> command to perform the calculation
of the lattice length for a given input file.</p>
<p>Also Quantum Espresso outputs the unit cell volume (in Bohr cubed) so we can
read this rather than calculating it ourselves.</p>
<p>This gives us the following script:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-0-2">
</span><span id="__span-0-3"><span class="nv">template</span><span class="o">=</span><span class="s2">&quot;C_diamond_base.in&quot;</span>
</span><span id="__span-0-4"><span class="nv">repstr</span><span class="o">=</span><span class="s2">&quot;xxxx&quot;</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="c1"># The &quot;for&quot; construction we&#39;ve used previously only handles integers.</span>
</span><span id="__span-0-7"><span class="c1"># So we set an initial value for A and its delta value as variables.</span>
</span><span id="__span-0-8"><span class="nv">a1</span><span class="o">=</span><span class="m">3</span>.40
</span><span id="__span-0-9"><span class="nv">da</span><span class="o">=</span><span class="m">0</span>.02
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">00</span>..10..1<span class="o">}</span>
</span><span id="__span-0-12"><span class="k">do</span>
</span><span id="__span-0-13"><span class="w">  </span><span class="nv">inp</span><span class="o">=</span><span class="s2">&quot;C_diamond_</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.in&quot;</span>
</span><span id="__span-0-14"><span class="w">  </span><span class="c1"># bc is a calculator that can calculate expressions in the shell. We</span>
</span><span id="__span-0-15"><span class="w">  </span><span class="c1"># pass it our calculation with echo and save the result as a variable.</span>
</span><span id="__span-0-16"><span class="w">  </span><span class="nv">a</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$a1</span><span class="s2"> + </span><span class="nv">$i</span><span class="s2"> * </span><span class="nv">$da</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-0-17"><span class="w">  </span>sed<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$repstr</span><span class="s2">/</span><span class="nv">$a</span><span class="s2">/&quot;</span><span class="w"> </span><span class="nv">$template</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$inp</span>
</span><span id="__span-0-18"><span class="w">  </span>pw.x<span class="w"> </span>&lt;<span class="w"> </span><span class="nv">$inp</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">inp</span><span class="p">%.*</span><span class="si">}</span>.out
</span><span id="__span-0-19"><span class="k">done</span>
</span><span id="__span-0-20">
</span><span id="__span-0-21">awk<span class="w"> </span><span class="s1">&#39;/unit-cell volume/{vol=$4}</span>
</span><span id="__span-0-22"><span class="s1">     /^!.*total/{print vol, $5}&#39;</span><span class="w"> </span>*out<span class="w"> </span>&gt;<span class="w"> </span>etot_v_vol.dat
</span></code></pre></div></td></tr></table></div>
<p>Save this script in the calculation directory and use it to obtain a
file with the total energy versus volume of carbon diamond.</p>
<p>Let's generate a plot of this with <code>gnuplot</code> and make sure it looks sensible.
A simple <code>gnuplot</code> script <a href="../01_diamond_volume/etot_v_vol.gpl"><code>etot_v_vol.gpl</code></a>
is already in the calculation directory. The contents are as follows:</p>
<p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">set title &quot;Carbon Diamond, ecutwfc=60 Ry&quot;
</span><span id="__span-1-2">set xlabel &quot;Unit Cell Volume (Bohr^3)&quot;
</span><span id="__span-1-3">set ylabel &quot;Total Energy (Ry)&quot;
</span><span id="__span-1-4">set term pngcairo
</span><span id="__span-1-5">set output &quot;etot_v_vol.png&quot;
</span><span id="__span-1-6">plot &quot;etot_v_vol.dat&quot;
</span></code></pre></div></td></tr></table></div>
This sets a title and axes labels, sets the output type to png, and sets and
output filename, then plots the data as we've seen before. All these commands
could be entered directly in gnuplot, but it can be easier to save them as a
script if you want to come back in the future and make minor modifications. If
your run this script with <code>gnuplot etot_v_vol.gpl</code> you'll see a png file of
the plot has been produced in the directory. You can quickly view this with
<code>display etot_v_vol.png</code>.</p>
<h3 id="task"><em>Task</em></h3>
<ul>
<li>What is the calculated volume with the lowest total energy?</li>
<li>What lattice length does this correspond to?</li>
<li>Modify the script to calculate 21 points from A=3.40 to A=3.60 inclusive.</li>
<li>Repeat this last calculation for energy cut-offs of 40 Ry and 80 Ry. Note,
  you should set a different filename for the data file each time or rename
  the previous data file before running this so you can compare them all
  directly..</li>
<li>Plot all the data for all three energy cut-offs together in gnuplot. Note
  you can plot several data files in gnuplot by separating them with a comma -
  e.g. <code>plot "data1.dat", "data2.dat"</code>. Save the output as a png file.</li>
</ul>
<h2 id="bulk-modulus-of-diamond">Bulk Modulus of diamond</h2>
<p>You may have realised that we could use the results of our previous
calculations to predict the bulk modulus of diamond. The bulk modulus is
proportional to the second derivative of the energy with respect to volume at
the equilibrium volume. Say we approximate our crystal as a harmonic solid,
then we could fit a harmonic expression to it to obtain a value for the
bulk modulus, <em>K</em> in <code>gnuplot</code>. We can do that, and plot the fit together
with our data with the following <code>gnuplot</code> script.:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"># Define a function for a simple harmonic equation of state
</span><span id="__span-2-2">E(x) = E0 + K*(x - V0)**2/(2*V0)
</span><span id="__span-2-3"># It&#39;s better to give initial guesses for a good fit. You can make a good
</span><span id="__span-2-4"># guess at E0 and V0 from the data plot you generated earlier.
</span><span id="__span-2-5">E0=-22.782
</span><span id="__span-2-6">V0=74
</span><span id="__span-2-7">
</span><span id="__span-2-8"># The actual fit command. The parameters and errors will be output to your
</span><span id="__span-2-9"># terminal and to the file &#39;fit.log&#39;.
</span><span id="__span-2-10">fit E(x) &quot;etot_v_vol.dat&quot; via E0, V0, K
</span><span id="__span-2-11">
</span><span id="__span-2-12"># Let&#39;s also produce a plot of the fit along with our data. We can use the
</span><span id="__span-2-13"># same settings as before.
</span><span id="__span-2-14">set title &quot;Carbon Diamond, ecutwfc=60 Ry&quot;
</span><span id="__span-2-15">set xlabel &quot;Unit Cell Volume (Bohr^3)&quot;
</span><span id="__span-2-16">set ylabel &quot;Total Energy (Ry)&quot;
</span><span id="__span-2-17">set term pngcairo
</span><span id="__span-2-18">set output &quot;etot_v_vol_fit.png&quot;
</span><span id="__span-2-19">
</span><span id="__span-2-20"># The fit parameters are set a their optimized values at the end of the fit
</span><span id="__span-2-21"># command above, so we can simply plot E(x).
</span><span id="__span-2-22">plot &quot;etot_v_vol.dat&quot;, E(x)
</span></code></pre></div></td></tr></table></div>
<p>Looking at the fit parameters, we can see that we obtain a value for <em>K</em> and
the equilibrium volume <em>V0</em> directly. The value of <em>V0</em> will be in whatever
units were used for input volumes, so Bohr^3 in our case. The value of <em>K</em>
will be in units of Energy/Volume. If we want to compare to the experimental
value we'll need to convert to a more standard unit. 1 Ry is 2.179872325E-18
J, and 1 Bohr^3 is (5.2917721067E-11)^3 m^3. If you don't want to be copy and
pasting numbers to a spreadsheet or similar, another useful way to do
calculations in the terminal is using python. Type <code>python</code> to start an
interactive session. Type whatever expressions you want, and type <code>ctrl+d</code> or
<code>quit()</code> to exit python once you're done.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1">python
</span><span id="__span-3-2">&gt;&gt;&gt; K * 2.179872325E-18 / (5.2917721067E-11)**3 # Enter your K value here.
</span><span id="__span-3-3">&gt;&gt;&gt; _ * 1e-9 # Convert the last result (&#39;_&#39;) to GPa
</span></code></pre></div></td></tr></table></div>
<p>The usual measured value for the bulk modulus of diamond is around 540 GPa.
How close to this are we?</p>
<h3 id="task_1"><em>Task</em></h3>
<ul>
<li>Convert the fit error to GPa also so we have an estimate of our accuracy.</li>
<li>Repeat the above fit for the data produced with different energy cut-off
  earlier. How do the values and errors compare?</li>
<li>A more advanced expression for the equation of state in a solid is the
  <a href="https://en.wikipedia.org/wiki/Birch%E2%80%93Murnaghan_equation_of_state">Birch Murnaghan Equation of
  State</a>.
  See if you can fit this expression to your data. The E(V) expression could
  be written in gnuplot as
  <div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">  E(x) = E0 + 9.0/16.0*V0*K*( Kp*((V0/x)**(2.0/3.0) - 1)**3 + ((V0/x)**(2.0/3.0) - 1)**2 * (6.0 - 4.0*(V0/x)**(2.0/3.0)))
</span></code></pre></div></td></tr></table></div><ul>
<li>Note the expression also depends on the parameter <em>Kp</em> so you'll need
  to add this to the list of fit parameters in the gnuplot <code>fit</code> command.</li>
<li>How does the error in the fit value of <code>K</code> change with this new fit?</li>
<li>Generate a plot showing both fits for your most well converged set of
  data along with the data points.</li>
</ul>
</li>
</ul>
<h2 id="h2-bond-length">H2 Bond Length</h2>
<p>For simple molecules we can calculate the total energy versus bond length in
the same way. This calculation is set up in the directory
<a href="02_H2_bond"><code>02_H2_bond</code></a>. Again, we're going to use a short script to modify
a single value in a template input file and run a series of calculations. Take
a look at the template input file first. We're not using any new inputs here.
We've placed one atom at the origin, and the second will be moved along the
x-axis.</p>
<p>We'll make a few modifications to the script this time though so that we parse
the data from the output files as they are generated and use the bond-length
value from the script. Save the following to a script in the calculation
directory:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3"><span class="nv">template</span><span class="o">=</span><span class="s2">&quot;H2_base.in&quot;</span>
</span><span id="__span-5-4"><span class="nv">repstr</span><span class="o">=</span><span class="s2">&quot;xxxx&quot;</span>
</span><span id="__span-5-5">
</span><span id="__span-5-6"><span class="c1"># Again we set an initial value for the x-coordinate of on H-atom and a delta</span>
</span><span id="__span-5-7"><span class="c1"># value as variables.</span>
</span><span id="__span-5-8"><span class="nv">hx1</span><span class="o">=</span><span class="m">0</span>.700
</span><span id="__span-5-9"><span class="nv">dhx</span><span class="o">=</span><span class="m">0</span>.005
</span><span id="__span-5-10">
</span><span id="__span-5-11"><span class="c1"># Empty the file, since we&#39;ll be appending to it in the calculation loop.</span>
</span><span id="__span-5-12">&gt;<span class="w"> </span>etot_v_bl.dat
</span><span id="__span-5-13">
</span><span id="__span-5-14"><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">00</span>..40..1<span class="o">}</span>
</span><span id="__span-5-15"><span class="k">do</span>
</span><span id="__span-5-16"><span class="w">  </span><span class="nv">inp</span><span class="o">=</span><span class="s2">&quot;H2_</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.in&quot;</span>
</span><span id="__span-5-17"><span class="w">  </span><span class="c1"># We save the output filename to a variable also.</span>
</span><span id="__span-5-18"><span class="w">  </span><span class="nv">out</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">inp</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.out&quot;</span>
</span><span id="__span-5-19">
</span><span id="__span-5-20"><span class="w">  </span><span class="c1"># Again we use bc to get the atomic position for each input.</span>
</span><span id="__span-5-21"><span class="w">  </span><span class="nv">hx</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$hx1</span><span class="s2"> + </span><span class="nv">$i</span><span class="s2"> * </span><span class="nv">$dhx</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>bc<span class="k">)</span>
</span><span id="__span-5-22"><span class="w">  </span>sed<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$repstr</span><span class="s2">/</span><span class="nv">$hx</span><span class="s2">/&quot;</span><span class="w"> </span><span class="nv">$template</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$inp</span>
</span><span id="__span-5-23"><span class="w">  </span>pw.x<span class="w"> </span>&lt;<span class="w"> </span><span class="nv">$inp</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span><span class="nv">$out</span>
</span><span id="__span-5-24">
</span><span id="__span-5-25"><span class="w">  </span><span class="c1"># awk is inside the loop this time, and we are appending to the data file</span>
</span><span id="__span-5-26"><span class="w">  </span><span class="c1"># after each calculation completes.</span>
</span><span id="__span-5-27"><span class="w">  </span>awk<span class="w"> </span>-v<span class="w"> </span><span class="nv">bl</span><span class="o">=</span><span class="nv">$hx</span><span class="w"> </span><span class="s1">&#39;/^!.*total/{print bl, $5}&#39;</span><span class="w"> </span><span class="nv">$out</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>etot_v_bl.dat
</span><span id="__span-5-28"><span class="k">done</span>
</span></code></pre></div></td></tr></table></div>
<p>Take a look at the data file. What bond length minimizes the energy?</p>
<p>Plot this data in <code>gnuplot</code>. You may want to copy and modify the script we
used earlier for diamond.</p>
<h2 id="h2-vibration-frequency">H2 Vibration Frequency</h2>
<p>As you may have realised, we can use what we already calculated here to find
the H2 vibration frequency. If we assume the variation in energy with bond
length is approximately quadratic (how good an assumption do you think this
is?) we can fit a function to the data in <code>gnuplot</code> and find the vibrational
frequency.</p>
<p>We can modify the gnuplot script we used earlier to fit and plot this function
with our data as follows:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">E(x) = E0 + k*(x-x0)**2
</span><span id="__span-6-2">fit E(x) &quot;etot_v_bl.dat&quot; via E0, x0, k
</span><span id="__span-6-3">
</span><span id="__span-6-4">set title &quot;Hydrogen Molecule&quot;
</span><span id="__span-6-5">set xlabel &quot;Bond Length (Angstrom)&quot;
</span><span id="__span-6-6">set ylabel &quot;Total Energy (Ry)&quot;
</span><span id="__span-6-7">set term pngcairo
</span><span id="__span-6-8">set output &quot;etot_v_bl_fit.png&quot;
</span><span id="__span-6-9">
</span><span id="__span-6-10">plot &quot;etot_v_bl.dat&quot;, E(x)
</span></code></pre></div></td></tr></table></div>
<p>Use this script to make a png plot and inspect it. How good a fit do you think
we have?</p>
<h3 id="task_2"><em>Task</em></h3>
<ul>
<li>Modify the calculation script to calculate 40 values over a range of
  0.1 Angstrom near the minimum. Also repeat the fit.<ul>
<li>How does the fit compare to the previous one?</li>
</ul>
</li>
<li>The fit has produced a value for an effective spring-constant <em>k</em> for the
  H2 vibration. <em>k</em> is in units of Rydberg per Angstrom^2. Find the frequency
  of vibration of the molecule in THz. Note, since we calculated <em>k</em> by fixing
  one atom and moving the other, you will need to use the reduced mass of
  the pair of atoms.<ul>
<li>What would the frequency be for a molecule made of two deuterium atoms?</li>
</ul>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>